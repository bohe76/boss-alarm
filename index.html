<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>보스 알리미</title>
    <link rel="stylesheet" href="src/style.css?v=2.3.4">
    <link rel="icon" href="images/favicon.svg" type="image/svg+xml">
</head>
<body>
    <header>
        <div class="header-container">
            <button id="sidebarToggle" class="sidebar-toggle">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="sidebar-toggle-icon">
                    <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                </svg>
            </button>
            <h1>🎙️ 보스 알리미</h1>
            <button id="alarmToggleButton" class="alarm-toggle-button">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="alarm-icon">
                    <text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" font-family="sans-serif" font-size="12" font-weight="bold">ON</text>
                </svg>
            </button>

        </div>
    </header>

    <div id="full-height-content" class="app-container">
        <nav id="sidebar" class="sidebar">
            <ul class="sidebar-menu">
                <li>
                    <a href="#" id="nav-dashboard" data-screen="dashboard-screen">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="menu-icon">
                            <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                        </svg>
                        <span class="menu-text">대시보드</span>
                    </a>
                </li>
                <li>
                    <a href="#" id="nav-boss-management" data-screen="boss-management-screen">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="menu-icon">
                            <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
                        </svg>
                        <span class="menu-text">보스 설정</span>
                    </a>
                </li>
                <li>
                    <a href="#" id="nav-boss-scheduler" data-screen="boss-scheduler-screen">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="menu-icon">
                            <path d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11zM5 7V6h14v1H5zM7 11h5v5H7z"/>
                        </svg>
                        <span class="menu-text">보스 스케줄러</span>
                    </a>
                </li>
                <li>
                    <a href="#" id="nav-calculator" data-screen="calculator-screen">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="menu-icon">
                            <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 16c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm-2-4c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm4 0c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm2-4c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zM7 5h10v2H7V5z"/>
                        </svg>
                        <span class="menu-text">계산기</span>
                    </a>
                </li>
                <li>
                    <a href="#" id="nav-share" data-screen="share-screen">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="menu-icon">
                            <path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.52.48 1.2.77 1.96.77 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L7.94 11.02c-.52-.48-1.2-.77-1.96-.77-1.66 0-3 1.34-3 3s1.34 3 3 3c.76 0 1.44-.3 1.96-.77l7.05 4.11c-.05.23-.09.46-.09.7 0 1.66 1.34 3 3 3s3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                        <span class="menu-text">공유</span>
                    </a>
                </li>
                <li>
                    <a href="#" id="nav-alarm-log" data-screen="alarm-log-screen">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="menu-icon">
                            <path d="M13 3H6c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-7-5zm1 14H8v-2h6v2zm2-4H8v-2h8v2zm0-4H8V9h8v2zm-1-5V3.5L18.5 9H13z"/>
                        </svg>
                        <span class="menu-text">알림 로그</span>
                    </a>
                </li>
                <li>
                    <a href="#" id="nav-notification-settings" data-screen="notification-settings-screen">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="menu-icon">
                            <path d="M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.09-.73-1.71-.98l-.37-2.65c-.05-.24-.27-.42-.52-.42h-4c-.25 0-.47.18-.52.42l-.37 2.65c-.62.25-1.19.59-1.71.98l-2.49-1c-.22-.09-.49 0-.61.22l-2 3.46c-.12.22-.07.49.12.64l2.11 1.65c-.04.32-.07.64-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.09.73 1.71.98l.37 2.65c.05.24.27.42.52.42h4c.25 0 .47-.18.52-.42l.37-2.65c.62-.25 1.19-.59 1.71-.98l2.49 1c.22.09.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"/>
                        </svg>
                        <span class="menu-text">알림 설정</span>
                    </a>
                </li>
                <li>
                    <a href="#" id="nav-help" data-screen="help-screen">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="menu-icon">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"/>
                        </svg>
                        <span class="menu-text">도움말</span>
                    </a>
                </li>
                <li>
                    <a href="#" id="nav-version-info" data-screen="version-info-screen">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="menu-icon">
                            <path d="M11 17h2v-6h-2v6zm1-15C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>
                        </svg>
                        <span class="menu-text">릴리즈 노트</span>
                    </a>
                </li>
            </ul>
        </nav>

        <main id="main-content-area" class="main-content-area">
            <!-- All existing content will be moved here, and then dynamically loaded per screen -->
            <!-- For now, we'll put a placeholder or move existing content here temporarily -->
            <section id="dashboard-screen" class="screen active">
                <h2>대시보드</h2>
                <div id="nextBossDisplay" class="next-boss-highlight"></div>
                <div id="upcomingBossList">
                    <h3>다가오는 보스</h3>
                    <!-- Upcoming boss list will be rendered here by JavaScript -->
                </div>
                <div id="alarmStatusSummary">
                    <h3>알림 상태</h3>
                    <div id="alarmStatusText"></div>
                </div>
                <span class="next-boss-label">알림 로그</span>
                <div id="recentAlarmLog">
                    <h3>최근 알림 로그</h3>
                    <!-- Recent alarm log entries will be rendered here by JavaScript -->
                </div>
            </section>

            <section id="boss-management-screen" class="screen">
                <h2>보스 설정</h2>
                <p class="boss-management-instruction">알림을 원하지 않는 보스는 알림 중지 후, 텍스트에서 삭제하고, 다시 알림을 활성화 해주세요.</p>
                <textarea id="bossListInput"></textarea>
            </section>

            <section id="calculator-screen" class="screen">
                <h2>계산기</h2>
                <div id="zenCalculatorCard" class="calculator-card">
                    <h3>젠 계산기</h3>
                    <div class="calculator-input-group">
                        <label for="remainingTimeInput">남은 시간 (HH:MM 또는 HH:MM:SS):</label>
                        <input type="text" id="remainingTimeInput" placeholder="예: 00:57:23 또는 00:05">
                    </div>
                    <div class="calculator-result-group">
                        <label>보스 출현 시간</label>
                        <span id="bossAppearanceTimeDisplay" class="result-display">--:--:--</span>
                    </div>
                </div>

                <div id="lightCalculatorCard" class="calculator-card">
                    <h3>광 계산기</h3>
                    <div class="light-calculator-controls">
                        <div class="light-stopwatch-display-group">
                            <label>경과 시간</label>
                            <span id="lightStopwatchDisplay" class="result-display">00:00</span>
                        </div>
                        <div class="light-buttons">
                            <button id="lightStartButton" class="button">시작</button>
                            <button id="lightGwangButton" class="button" disabled>광</button>
                            <button id="lightCaptureButton" class="button" disabled>잡힘</button>
                            <button id="lightListButton" class="button">목록</button>
                        </div>
                    </div>
                    <div class="light-calculation-results">
                        <div class="light-expected-time-group">
                            <label><span class="expected-text">잡힘</span> <span class="expected-label">예상 시간</span></label>
                            <span id="lightExpectedTimeDisplay" class="result-display">--:--</span>
                        </div>
                    </div>
                    <div id="lightTempResults" class="light-temp-results">
                        <!-- Temporary results after capture will be displayed here -->
                    </div>
                    <div id="lightSavedList" class="light-saved-list">
                        <div class="light-saved-list-header">
                            <h4>저장된 광 계산 기록</h4>
                            <button id="clearLightRecordsButton" class="button">기록 초기화</button>
                        </div>
                        <!-- Saved list will be displayed here -->
                    </div>
                </div>
            </section>

            <section id="boss-scheduler-screen" class="screen">
                <h2>보스 스케줄러</h2>
                <!-- Boss Scheduler UI will be rendered here by JavaScript -->
            </section>

            <section id="notification-settings-screen" class="screen">
                <h2>알림 설정</h2>
                <div class="fixed-alarm-section">
                    <div class="fixed-alarm-header">
                        <h3>고정 알림</h3>
                    </div>
                    <div id="fixedAlarmList">
                        <!-- Fixed alarms will be rendered here by JavaScript -->
                    </div>
                </div>
                <!-- Other notification settings will go here -->
            </section>

            <section id="alarm-log-screen" class="screen">
                <div class="log-header">
                    <h2>알림 로그</h2>
                </div>
                <div id="log-container"></div>
            </section>

            <section id="version-info-screen" class="screen">
                <h2>릴리즈 노트</h2>
                <div id="versionHistoryContent">
                    <!-- Version History content will be loaded here by JavaScript -->
                </div>
            </section>

            <section id="share-screen" class="screen">
                <h2>공유</h2>
                <p>현재 설정된 보스 목록을 다른 사람과 쉽게 공유 할 수 있는 고유 링크를 생성합니다</p>
                <div id="shareMessage" class="add-alarm-card"></div>
            </section>

            <section id="help-screen" class="screen">
                <h2>도움말</h2>
                <div id="featureGuideContent">
                    <!-- Feature Guide content will be loaded here -->
                </div>
            </section>

            <!-- The help modal itself will be removed as its content is now part of the help screen -->
        </main>
    </div>

    <script type="module">
        window.APP_VERSION = "2.3.4"; // Define global app version

        import { initDomElements } from './src/dom-elements.js';

        import { initLogger, log } from './src/logger.js';
        import { BossDataManager, LocalStorageManager } from './src/data-managers.js';

        import { speak } from './src/speech.js'; // Import speak function

        import { parseBossList } from './src/boss-parser.js';
        import { startAlarm, stopAlarm, getIsAlarmRunning } from './src/alarm-scheduler.js';
        import { updateBossListTextarea, renderFixedAlarms, updateFixedAlarmVisuals } from './src/ui-renderer.js';
        import { getShortUrl } from './src/api-service.js';
        import { initApp } from './src/event-handlers.js';

        // --- 11. 페이지가 처음 로드될 때 실행되는 함수 ---
        window.addEventListener('load', () => {
            initApp();
        });
    </script>
    <div id="global-tooltip"></div>
    <footer>
        <p>Created by: bohe | v2.3.4</p>
    </footer>
</body>
</html>