<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë³´ìŠ¤ ì•Œë¦¬ë¯¸</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
                Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
            line-height: 1.6;
            background-color: #f4f7f6;
            color: #333;
            padding: 20px;
            max-width: 700px;
            margin: 0 auto;
        }
        h1, h2, h3 {
            color: #111;
        }
        textarea {
            width: 95%;
            height: 250px;
            border: 1px solid #ccc;
            border-radius: 8px;
            padding: 10px;
            font-size: 14px;
            margin-bottom: 15px;
        }
        /* ê³µí†µ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        button {
            border: none;
            padding: 12px 20px;
            font-size: 16px;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
            width: 95%;
            margin-bottom: 10px;
        }
        
        /* ì•Œë¦¼ ì‹œì‘/ì¤‘ì§€ ë²„íŠ¼ */
        #startButton { background-color: #007aff; color: white; }
        #startButton:hover { background-color: #0056b3; }
        #startButton.running { background-color: #d90007; }
        #startButton.running:hover { background-color: #b30006; }

        /* ê³µìœ  ë§í¬ ìƒì„± ë²„íŠ¼ */
        #shareButton { background-color: #34c759; color: white; }
        #shareButton:hover { background-color: #2a9e48; }
        #shareButton:disabled { background-color: #aaa; cursor: not-allowed; }
        
        /* ë§í¬ ì…ë ¥ì°½ + ë³µì‚¬ ë²„íŠ¼ ê·¸ë£¹ */
        .input-group {
            display: flex;
            width: 95%;
            align-items: center;
        }
        
        /* ë§í¬ í‘œì‹œì°½ */
        #shareLinkInput {
            flex-grow: 1; /* ë‚¨ëŠ” ê³µê°„ì„ ëª¨ë‘ ì°¨ì§€ */
            padding: 10px;
            font-size: 14px;
            border: 1px solid #ccc;
            border-radius: 8px 0 0 8px; /* ì™¼ìª½ ëª¨ì„œë¦¬ */
            background-color: #eee;
            margin: 0;
            /* input íƒœê·¸ì˜ ê¸°ë³¸ ìŠ¤íƒ€ì¼ ì´ˆê¸°í™” */
            border-right: none;
        }
        
        /* ë³µì‚¬ ë²„íŠ¼ */
        #copyButton {
            width: auto; /* ë‚´ìš©ì— ë§ê²Œ ë„ˆë¹„ ì¡°ì ˆ */
            padding: 10px 15px;
            font-size: 14px;
            margin: 0;
            border-radius: 0 8px 8px 0; /* ì˜¤ë¥¸ìª½ ëª¨ì„œë¦¬ */
            background-color: #6c757d;
            color: white;
        }
        #copyButton:hover {
            background-color: #5a6268;
        }

        /* ì•Œë¦¼ ë¡œê·¸ ì°½ */
        #log-container {
            margin-top: 20px;
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            height: 200px;
            overflow-y: auto;
        }
        .log-entry { 
            padding: 5px 0; 
            border-bottom: 1px dashed #eee; 
        }
        .log-entry.important { 
            font-weight: bold; 
            color: #d90007; 
        }
    </style>
</head>
<body>

    <h1>ğŸ™ï¸ ë³´ìŠ¤ ì•Œë¦¬ë¯¸</h1>
    <p>
        ëª©ë¡ì„ ìˆ˜ì •í•œ ë’¤ 'ê³µìœ  ë§í¬ ìƒì„±' ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì§§ì€ URLì´ ìƒì„±ë©ë‹ˆë‹¤.<br>
        ìƒì„±ëœ ë§í¬ ì˜†ì˜ 'ë³µì‚¬' ë²„íŠ¼ì„ ëˆŒëŸ¬ ê³µìœ í•˜ì„¸ìš”.<br>
        ë“£ê³  ì‹¶ì§€ ì•Šì€ ë³´ìŠ¤ëŠ” ì•Œë¦¼ ì¤‘ì§€ í›„, í…ìŠ¤íŠ¸ì—ì„œ ì‚­ì œí•˜ê³ , ë‹¤ì‹œ ì•ŒëŒì„ í™œì„±í™” í•´ì£¼ì„¸ìš”.
    </p>

    <textarea id="bossListInput">
11:00 ì…€ë¡œë¹„ì•„
11:00 ë‹ˆë“œí˜¸ê·¸
11:01 ë¼íƒ€í† ìŠ¤í¬
11:02 ì§€ê°4ì¸µ
11:13 ì§€ê°7ì¸µ
11:17 í—¤ë¥´ëª¨ë“œ
11:22 í˜í‹°
11:25 ìˆ˜ë“œë¦¬
11:27 ìƒ¤ë¬´í¬
11:30 í† ë¥´
11:33 ë¹„ìš”ë¥¸
11:40 ë“œë¼ìš°ê·¸
11:46 ëª¨ë„¤ê°€ë¦„
11:52 ìŠ¤ì¹¼ë¼ë‹ˆë¥´
12:09 ì§€ê°10ì¸µ
13:06 íŒŒë¥´ë°”
13:07 ë¸Œë¥€íë“œ
13:13 ë°”ìš°í‹°
13:17 ìˆ˜ë¥´íŠ¸
13:51 ë¼ì´ë…¸ë¥´
14:18 í‹°ë¥´
14:39 ì•¼ë¥¸
14:53 ì—˜ë“œë£¬
14:59 ìŠ¤ë°”ë¥´íŠ¸
16:35 íë‹ˆë¥´
16:36 ë©”ê¸°ë¥´
17:39 ìŠ¤ì¹¼ë“œë©”ë¥´
19:34 ì‹ ë§ˆë¼
19:42 ìš°ë¡œë³´ë¡œìŠ¤
20:08 íƒ•ê·¸ë¦¬ìŠ¤ë‹ˆë¥´
20:13 ë‘ë¼ìŠ¤ë¡œë¥´
20:13 í—¤ë¥´ê°€ë¦„
20:59 êµ´ë² ì´ê·¸
21:43 í™”ì‹ ê·¸ë¡œì•„
22:01 ì˜¤ë”˜
23:00 ì…€ë¡œë¹„ì•„
23:00 ë‹ˆë“œí˜¸ê·¸
23:01 ë¼íƒ€í† ìŠ¤í¬
23:02 ì§€ê°4ì¸µ
23:17 í—¤ë¥´ëª¨ë“œ
23:22 í˜í‹°
23:25 ìˆ˜ë“œë¦¬
23:29 ë…¸íŠ¸
23:33 ë¹„ìš”ë¥¸
23:52 ìŠ¤ì¹¼ë¼ë‹ˆë¥´
01:06 íŒŒë¥´ë°”
01:07 ë¸Œë¥€íë“œ
01:13 ë°”ìš°í‹°
01:51 ë¼ì´ë…¸ë¥´
02:39 ì•¼ë¥¸
03:50 ë¯¸ë¯¸ë¥´
04:35 íë‹ˆë¥´
05:50 ë°œë¦¬
    </textarea>

    <br>
    
    <button id="startButton">ì•Œë¦¼ ì‹œì‘</button>
    
    <h3>ê³µìœ í•˜ê¸°</h3>
    
    <button id="shareButton">ê³µìœ  ë§í¬ ìƒì„± (Short URL)</button>
    
    <div class="input-group">
        <input type="text" id="shareLinkInput" value="ëª©ë¡ ìˆ˜ì • í›„ ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”" readonly>
        <button id="copyButton">ë³µì‚¬</button>
    </div>

    <h2>ì•Œë¦¼ ë¡œê·¸</h2>
    
    <div id="log-container"></div>

    <script>
        // --- 1. DOM ìš”ì†Œ ê°€ì ¸ì˜¤ê¸° ---
        const bossListInput = document.getElementById('bossListInput');
        const startButton = document.getElementById('startButton');
        const logContainer = document.getElementById('log-container');
        const shareButton = document.getElementById('shareButton');
        const shareLinkInput = document.getElementById('shareLinkInput');
        const copyButton = document.getElementById('copyButton');

        // --- 2. ì „ì—­ ë³€ìˆ˜ ì„¤ì • ---
        // ì›¹í˜ì´ì§€ ì „ì²´ì—ì„œ ì‚¬ìš©í•  ë³€ìˆ˜ë“¤ì„ ë¯¸ë¦¬ ì„ ì–¸í•©ë‹ˆë‹¤.
        let bossSchedule = []; // íŒŒì‹±ëœ ë³´ìŠ¤ ì •ë³´ë¥¼ ì €ì¥í•  ë°°ì—´
        let alertTimerId = null; // 1ì´ˆë§ˆë‹¤ ì•ŒëŒì„ ì²´í¬í•˜ëŠ” íƒ€ì´ë¨¸ì˜ ID (ë‚˜ì¤‘ì— ì¤‘ì§€ì‹œí‚¬ ë•Œ í•„ìš”)
        let isAlarmRunning = false; // ì•ŒëŒì´ í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ì§€ ìƒíƒœë¥¼ ì €ì¥í•˜ëŠ” ë³€ìˆ˜ (í† ê¸€ìš©)


        // --- 3. ìŒì„± ì¬ìƒ í•¨ìˆ˜ ---
        // í…ìŠ¤íŠ¸ë¥¼ ë°›ì•„ì„œ AI ìŒì„±ìœ¼ë¡œ ì½ì–´ì£¼ëŠ” ê¸°ëŠ¥ì„ í•©ë‹ˆë‹¤.
        function speak(text) {
            // ë¸Œë¼ìš°ì €ê°€ ìŒì„± ì¶œë ¥(TTS) ê¸°ëŠ¥ì„ ì§€ì›í•˜ì§€ ì•Šìœ¼ë©´ í•¨ìˆ˜ë¥¼ ì¦‰ì‹œ ì¢…ë£Œ
            if (!window.speechSynthesis) {
                console.warn("ì´ ë¸Œë¼ìš°ì €ëŠ” ìŒì„± í•©ì„±ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
                return;
            }
            
            // í˜¹ì‹œ ì´ì „ì— ì¬ìƒ ì¤‘ì¸ ìŒì„±ì´ ìˆë‹¤ë©´ ì¦‰ì‹œ ì·¨ì†Œ (ì¤‘ë³µ ì¬ìƒ ë°©ì§€)
            window.speechSynthesis.cancel();
            
            // ì½ì–´ì¤„ ë‚´ìš©(text)ìœ¼ë¡œ ìŒì„± ê°ì²´(utterance)ë¥¼ ìƒì„±
            const utterance = new SpeechSynthesisUtterance(text);
            
            // ì–¸ì–´ë¥¼ í•œêµ­ì–´ë¡œ ì„¤ì •
            utterance.lang = 'ko-KR';
            
            // ìŒì„± ì¬ìƒ ì‹œì‘
            window.speechSynthesis.speak(utterance);
        }


        // --- 4. ë¡œê·¸ ê¸°ë¡ í•¨ìˆ˜ ---
        // í˜ì´ì§€ í•˜ë‹¨ì˜ ë¡œê·¸ ì°½ì— ë©”ì‹œì§€ë¥¼ ì¶”ê°€í•˜ëŠ” ê¸°ëŠ¥ì„ í•©ë‹ˆë‹¤.
        function log(message, isImportant = false) {
            // ìƒˆë¡œìš´ div ìš”ì†Œë¥¼ ìƒì„±
            const entry = document.createElement('div');
            entry.className = 'log-entry'; // ê¸°ë³¸ ìŠ¤íƒ€ì¼ í´ë˜ìŠ¤ ì ìš©
            
            // isImportantê°€ trueì´ë©´, 'important' í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•´ ê¸€ì”¨ë¥¼ ê°•ì¡°
            if (isImportant) {
                entry.classList.add('important');
            }
            
            // í˜„ì¬ ì‹œê°„ì„ ê°€ì ¸ì™€ì„œ ë©”ì‹œì§€ ì•ì— ë¶™ì—¬ì¤Œ (ì˜ˆ: [11:17:30])
            const now = new Date();
            entry.textContent = `[${now.toLocaleTimeString()}] ${message}`;
            
            // ì™„ì„±ëœ ë¡œê·¸ ë©”ì‹œì§€ë¥¼ ë¡œê·¸ ì»¨í…Œì´ë„ˆì— ì¶”ê°€
            logContainer.appendChild(entry);
            
            // í•­ìƒ ìµœì‹  ë¡œê·¸ê°€ ë³´ì´ë„ë¡ ìŠ¤í¬ë¡¤ì„ ë§¨ ì•„ë˜ë¡œ ì´ë™
            logContainer.scrollTop = logContainer.scrollHeight;
        }


        // --- 5. í…ìŠ¤íŠ¸ íŒŒì‹± í•¨ìˆ˜ ---
        // ì‚¬ìš©ìê°€ ì…ë ¥í•œ í…ìŠ¤íŠ¸ ìƒìì˜ ë‚´ìš©ì„ ì½ì–´ bossSchedule ë°°ì—´ í˜•íƒœë¡œ ê°€ê³µí•©ë‹ˆë‹¤.
        function parseBossList() {
            const text = bossListInput.value; // í…ìŠ¤íŠ¸ ìƒìì˜ ì „ì²´ í…ìŠ¤íŠ¸ë¥¼ ê°€ì ¸ì˜´
            
            bossSchedule = text
                .split('\n')                // 1. ì¤„ë°”ê¿ˆ(\n)ì„ ê¸°ì¤€ìœ¼ë¡œ ë‚˜ëˆ ì„œ ë°°ì—´ë¡œ ë§Œë“¦
                .map(line => line.trim())   // 2. ê° ì¤„ì˜ ì•ë’¤ ê³µë°±ì„ ì œê±°
                .filter(line => line)       // 3. ë‚´ìš©ì´ ì—†ëŠ” ë¹ˆ ì¤„ì€ ë°°ì—´ì—ì„œ ì œê±°
                .map(line => {              // 4. ê° ì¤„ì„ ì‹œê°„ê³¼ ì´ë¦„ìœ¼ë¡œ ë¶„ë¦¬í•˜ì—¬ ê°ì²´ë¡œ ë§Œë“¦
                    const parts = line.split(/\s+/); // ê³µë°±(ìŠ¤í˜ì´ìŠ¤, íƒ­ ë“±)ì„ ê¸°ì¤€ìœ¼ë¡œ ë‚˜ëˆ”
                    if (parts.length >= 2) {
                        // "11:00", "ì…€ë¡œë¹„ì•„" ê°™ì€ í˜•ì‹ì´ ë§ìœ¼ë©´ ê°ì²´ë¡œ ë³€í™˜
                        return {
                            time: parts[0],
                            name: parts[1],
                            alerted_5min: false, // 5ë¶„ ì „ ì•Œë¦¼ì„ í–ˆëŠ”ì§€ ì—¬ë¶€
                            alerted_1min: false, // 1ë¶„ ì „ ì•Œë¦¼ì„ í–ˆëŠ”ì§€ ì—¬ë¶€
                            alerted_0min: false, // ì •ê° ì•Œë¦¼ì„ í–ˆëŠ”ì§€ ì—¬ë¶€
                        };
                    }
                    return null; // í˜•ì‹ì´ ë§ì§€ ì•Šìœ¼ë©´ nullë¡œ ë°˜í™˜
                })
                .filter(item => item);      // 5. nullë¡œ ë°˜í™˜ëœ í•­ëª©(í˜•ì‹ ì˜¤ë¥˜)ì„ ìµœì¢… ë°°ì—´ì—ì„œ ì œê±°
            
            // íŒŒì‹±ì´ ëë‚œ í›„ ë¡œê·¸ë¥¼ ë‚¨ê¹€
            log(`${bossSchedule.length}ê°œì˜ ë³´ìŠ¤ ì¼ì •ì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.`);
        }


        // --- 6. ì•Œë¦¼ ì²´í¬ í•µì‹¬ í•¨ìˆ˜ ---
        // 1ì´ˆì— í•œ ë²ˆì”© ì‹¤í–‰ë˜ë©´ì„œ í˜„ì¬ ì‹œê°„ì´ ì•ŒëŒì„ ìš¸ë¦´ ì‹œê°„ì¸ì§€ ì²´í¬í•©ë‹ˆë‹¤.
        function checkAlarms() {
            const now = new Date();
            // "HH:MM" í˜•ì‹ìœ¼ë¡œ í˜„ì¬, 5ë¶„ ë’¤, 1ë¶„ ë’¤ ì‹œê°„ì„ ë§Œë“¦
            const currentTime = now.toTimeString().substring(0, 5);
            const fiveMinLater = new Date(now.getTime() + 5 * 60 * 1000); // 5ë¶„ = 300,000 ë°€ë¦¬ì´ˆ
            const fiveMinLaterTime = fiveMinLater.toTimeString().substring(0, 5);
            const oneMinLater = new Date(now.getTime() + 1 * 60 * 1000); // 1ë¶„ = 60,000 ë°€ë¦¬ì´ˆ
            const oneMinLaterTime = oneMinLater.toTimeString().substring(0, 5);

            // ìì •(00:00)ì´ ë˜ë©´ ëª¨ë“  ë³´ìŠ¤ì˜ ì•Œë¦¼ ìƒíƒœë¥¼ 'false'ë¡œ ì´ˆê¸°í™” (ë§¤ì¼ ë°˜ë³µì„ ìœ„í•¨)
            if (currentTime === '00:00') {
                let resetCount = 0;
                bossSchedule.forEach(boss => {
                    if (boss.alerted_5min || boss.alerted_1min || boss.alerted_0min) {
                        boss.alerted_5min = false;
                        boss.alerted_1min = false;
                        boss.alerted_0min = false;
                        resetCount++;
                    }
                });
                // ì´ˆê¸°í™”ëœ ë³´ìŠ¤ê°€ 1ê°œ ì´ìƒ ìˆì„ ë•Œë§Œ ë¡œê·¸ë¥¼ ë‚¨ê¹€
                if (resetCount > 0) {
                    log("ìì •ì´ ë˜ì–´ ëª¨ë“  ì•Œë¦¼ ìƒíƒœë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.", true);
                }
            }

            // ëª¨ë“  ë³´ìŠ¤ ëª©ë¡ì„ í•˜ë‚˜ì”© í™•ì¸
            for (const boss of bossSchedule) {
                
                // --- 5ë¶„ ì „ ì•Œë¦¼ ì²´í¬ ---
                // ë³´ìŠ¤ ì‹œê°„ì´ '5ë¶„ ë’¤ ì‹œê°„'ê³¼ ê°™ê³ , ì•„ì§ 5ë¶„ ì „ ì•Œë¦¼ì„ ì•ˆ í–ˆë‹¤ë©´
                if (boss.time === fiveMinLaterTime && !boss.alerted_5min) {
                    boss.alerted_5min = true; // ì•Œë¦¼ ìƒíƒœë¥¼ trueë¡œ ë°”ê¿”ì„œ ì¤‘ë³µ ì•Œë¦¼ ë°©ì§€
                    const msg = `5ë¶„ ì „, ${boss.name}`;
                    log(msg, true);
                    speak(msg);
                }

                // --- 1ë¶„ ì „ ì•Œë¦¼ ì²´í¬ ---
                // ë³´ìŠ¤ ì‹œê°„ì´ '1ë¶„ ë’¤ ì‹œê°„'ê³¼ ê°™ê³ , ì•„ì§ 1ë¶„ ì „ ì•Œë¦¼ì„ ì•ˆ í–ˆë‹¤ë©´
                if (boss.time === oneMinLaterTime && !boss.alerted_1min) {
                    boss.alerted_1min = true; // ì•Œë¦¼ ìƒíƒœë¥¼ trueë¡œ ë³€ê²½
                    const msg = `1ë¶„ ì „, ${boss.name}`;
                    log(msg, true);
                    speak(msg);
                }

                // --- ì •ê° ì•Œë¦¼ ì²´í¬ ---
                // ë³´ìŠ¤ ì‹œê°„ì´ 'í˜„ì¬ ì‹œê°„'ê³¼ ê°™ê³ , ì•„ì§ ì •ê° ì•Œë¦¼ì„ ì•ˆ í–ˆë‹¤ë©´
                if (boss.time === currentTime && !boss.alerted_0min) {
                    boss.alerted_0min = true; // ì•Œë¦¼ ìƒíƒœë¥¼ trueë¡œ ë³€ê²½
                    const msg = `${boss.name} ì   ì…ë‹ˆë‹¤.`;
                    log(msg, true);
                    speak(msg);
                }
            }
        }


        // --- 7. 'ì•Œë¦¼ ì‹œì‘/ì¤‘ì§€' í† ê¸€ ë²„íŠ¼ ì´ë²¤íŠ¸ ---
        startButton.addEventListener('click', () => {
            // ì•Œë¦¼ ì‹¤í–‰ ìƒíƒœë¥¼ ë°˜ëŒ€ë¡œ ë³€ê²½ (true -> false, false -> true)
            isAlarmRunning = !isAlarmRunning; 

            if (isAlarmRunning) {
                // --- ì•Œë¦¼ì„ ì¼œëŠ” ê²½ìš° ---
                startButton.textContent = "ì•Œë¦¼ ì¤‘ì§€ (ì‹¤í–‰ ì¤‘)";
                startButton.classList.add('running'); // ë¹¨ê°„ìƒ‰ ìŠ¤íƒ€ì¼ ì ìš©
                
                if (alertTimerId) clearInterval(alertTimerId); // ë§Œì•½ì˜ íƒ€ì´ë¨¸ ì œê±°

                // (ì¤‘ìš”) í…ìŠ¤íŠ¸ ìƒìì˜ ìµœì‹  ë‚´ìš©ìœ¼ë¡œ ëª©ë¡ì„ ë‹¤ì‹œ íŒŒì‹±
                parseBossList(); 
                
                log("ì•Œë¦¼ ì‹œìŠ¤í…œì„ ì‹œì‘í•©ë‹ˆë‹¤.");
                speak("ë³´ìŠ¤ ì•Œë¦¬ë¯¸ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.");
                
                // 1ì´ˆë§ˆë‹¤ checkAlarms í•¨ìˆ˜ ì‹¤í–‰ ì‹œì‘
                alertTimerId = setInterval(checkAlarms, 1000);

            } else {
                // --- ì•Œë¦¼ì„ ë„ëŠ” ê²½ìš° ---
                startButton.textContent = "ì•Œë¦¼ ì‹œì‘";
                startButton.classList.remove('running'); // ê¸°ë³¸ ìŠ¤íƒ€ì¼ë¡œ ë³µê·€
                
                // 1ì´ˆë§ˆë‹¤ ì‹¤í–‰ë˜ë˜ íƒ€ì´ë¨¸ë¥¼ ì¤‘ì§€
                if (alertTimerId) {
                    clearInterval(alertTimerId);
                    alertTimerId = null;
                }
                
                log("ì•Œë¦¼ ì‹œìŠ¤í…œì„ ì¤‘ì§€í•©ë‹ˆë‹¤.");
                speak("ì•Œë¦¬ë¯¸ë¥¼ ì¤‘ì§€í•©ë‹ˆë‹¤.");
            }
        });


        // --- 8. URL ë‹¨ì¶• í•¨ìˆ˜ (TinyURL API) ---
        // API í˜¸ì¶œì„ ê¸°ë‹¤ë ¤ì•¼ í•˜ë¯€ë¡œ async/await ì‚¬ìš©
        async function getShortUrl(longUrl) {
            // TinyURLì˜ ë¬´ë£Œ API ì£¼ì†Œ
            const apiUrl = `https://tinyurl.com/api-create.php?url=${encodeURIComponent(longUrl)}`;
            
            try {
                // fetch: APIì— ë„¤íŠ¸ì›Œí¬ ìš”ì²­(GET)ì„ ë³´ëƒ„
                const response = await fetch(apiUrl);
                
                if (response.ok) { // ì‘ë‹µì´ ì„±ê³µ(200)ì´ë©´
                    const shortUrl = await response.text(); // ì‘ë‹µ ë‚´ìš©ì„ í…ìŠ¤íŠ¸ë¡œ ë°›ìŒ (ì´ê²Œ ë‹¨ì¶• URL)
                    return shortUrl;
                } else {
                    // ì„œë²„ê°€ 404, 500 ë“± ì—ëŸ¬ë¥¼ ë°˜í™˜í•œ ê²½ìš°
                    throw new Error('API ì‘ë‹µ ì‹¤íŒ¨');
                }
            } catch (error) {
                // ë„¤íŠ¸ì›Œí¬ ì—°ê²° ì˜¤ë¥˜ ë˜ëŠ” ìœ„ì—ì„œ ë°œìƒì‹œí‚¨ ì—ëŸ¬
                console.error("URL ë‹¨ì¶• ì‹¤íŒ¨:", error);
                return null; // ì‹¤íŒ¨ ì‹œ null ë°˜í™˜
            }
        }


        // --- 9. 'ê³µìœ  ë§í¬ ìƒì„±' ë²„íŠ¼ ì´ë²¤íŠ¸ ---
        // APIë¥¼ í˜¸ì¶œí•´ì•¼ í•˜ë¯€ë¡œ async í•¨ìˆ˜ë¡œ ì •ì˜
        shareButton.addEventListener('click', async () => {
            
            // 1. ë²„íŠ¼ ë¹„í™œì„±í™” (ì¤‘ë³µ í´ë¦­ ë°©ì§€)
            shareButton.disabled = true;
            shareButton.textContent = "ë‹¨ì¶• URL ìƒì„± ì¤‘...";
            shareLinkInput.value = "ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”...";

            // 2. ì›ë³¸ ê¸´ URL ìƒì„±
            const currentData = bossListInput.value;
            const encodedData = encodeURIComponent(currentData); // ë°ì´í„°ë¥¼ URLì— ì“¸ ìˆ˜ ìˆê²Œ ì¸ì½”ë”©
            const baseUrl = window.location.href.split('?')[0]; // í˜„ì¬ ì£¼ì†Œì—ì„œ ? ì•ë¶€ë¶„ë§Œ ê°€ì ¸ì˜´
            const longUrl = `${baseUrl}?data=${encodedData}`;

            // 3. URL ë‹¨ì¶• ì‹œë„ (getShortUrl í•¨ìˆ˜ê°€ ëë‚  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¼)
            const shortUrl = await getShortUrl(longUrl);

            if (shortUrl) {
                // 4-1. ë‹¨ì¶• ì„±ê³µ ì‹œ
                shareLinkInput.value = shortUrl;
                log("ë‹¨ì¶• URLì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤. 'ë³µì‚¬' ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.", true);
            } else {
                // 4-2. ë‹¨ì¶• ì‹¤íŒ¨ ì‹œ (ê¸´ URLì„ ëŒ€ì‹  ì‚¬ìš©)
                shareLinkInput.value = longUrl;
                log("URL ë‹¨ì¶• ì‹¤íŒ¨. ëŒ€ì‹  ì›ë³¸ URLì„ ìƒì„±í•©ë‹ˆë‹¤.", true);
            }

            // 5. ë²„íŠ¼ ë‹¤ì‹œ í™œì„±í™”
            shareButton.disabled = false;
            shareButton.textContent = "ê³µìœ  ë§í¬ ìƒì„± (Short URL)";
        });


        // --- 10. 'ë³µì‚¬' ë²„íŠ¼ ì´ë²¤íŠ¸ ---
        copyButton.addEventListener('click', () => {
            const urlToCopy = shareLinkInput.value;
            
            // ë³µì‚¬í•  ë‚´ìš©ì´ ìˆëŠ”ì§€, ì´ˆê¸° í…ìŠ¤íŠ¸ê°€ ì•„ë‹Œì§€ í™•ì¸
            if (urlToCopy && urlToCopy !== "ëª©ë¡ ìˆ˜ì • í›„ ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”" && urlToCopy !== "ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”...") {
                
                // navigator.clipboard.writeText : í´ë¦½ë³´ë“œì— í…ìŠ¤íŠ¸ë¥¼ ì“°ëŠ” í‘œì¤€ API
                navigator.clipboard.writeText(urlToCopy).then(() => {
                    // ë³µì‚¬ ì„±ê³µ ì‹œ
                    log("ë§í¬ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.", true);
                    
                    // ì‚¬ìš©ì í”¼ë“œë°±: ë²„íŠ¼ í…ìŠ¤íŠ¸ë¥¼ ì ì‹œ ë³€ê²½
                    const originalText = copyButton.textContent;
                    copyButton.textContent = 'ë³µì‚¬ë¨!';
                    setTimeout(() => {
                        copyButton.textContent = originalText;
                    }, 1500); // 1.5ì´ˆ í›„ì— ì›ë˜ í…ìŠ¤íŠ¸ë¡œ ë³µê·€
                
                }).catch(err => {
                    // ë³µì‚¬ ì‹¤íŒ¨ ì‹œ (ì˜ˆ: http í™˜ê²½, ì˜¤ë˜ëœ ë¸Œë¼ìš°ì € ë“±)
                    log("ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ìˆ˜ë™ìœ¼ë¡œ ë³µì‚¬í•´ì£¼ì„¸ìš”.", true);
                    console.error('í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨:', err);
                });
            } else {
                log("ë³µì‚¬í•  ë§í¬ê°€ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ë§í¬ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.", false);
            }
        });


        // --- 11. í˜ì´ì§€ê°€ ì²˜ìŒ ë¡œë“œë  ë•Œ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜ ---
        window.addEventListener('load', () => {
            // í˜„ì¬ í˜ì´ì§€ì˜ URL íŒŒë¼ë¯¸í„°(ë¬¼ìŒí‘œ ë’¤)ë¥¼ ê°€ì ¸ì˜´
            const params = new URLSearchParams(window.location.search);
            
            // 'data'ë¼ëŠ” ì´ë¦„ì˜ íŒŒë¼ë¯¸í„°ê°€ ìˆëŠ”ì§€ í™•ì¸
            if (params.has('data')) {
                // 'data' ê°’ì„ ê°€ì ¸ì™€ì„œ 'ì••ì¶• í•´ì œ' (ë””ì½”ë”©)
                const decodedData = decodeURIComponent(params.get('data'));
                
                // í…ìŠ¤íŠ¸ ìƒì(textarea)ì˜ ë‚´ìš©ì„ URLì—ì„œ ê°€ì ¸ì˜¨ ë°ì´í„°ë¡œ ì±„ì›€
                bossListInput.value = decodedData;
                
                log("URLì—ì„œ ë³´ìŠ¤ ëª©ë¡ì„ ì„±ê³µì ìœ¼ë¡œ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.");
            } else {
                // URLì— dataê°€ ì—†ìœ¼ë©´
                log("ê¸°ë³¸ ë³´ìŠ¤ ëª©ë¡ì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤. (URL ë°ì´í„° ì—†ìŒ)");
            }
        });

    </script>
</body>
</html>