---
id: issue-003
title: "모바일 음성 알림 이슈 (Web Speech API 제약)"
status: "해결됨"
priority: "Medium"
assignee: "Gemini"
labels:
  - bug
  - mobile
  - audio
  - notification
  - web-speech-api
created_date: "2025-11-23"
resolved_date: "2025-12-04"
---

# Issue-003: 모바일 음성 알림 이슈 (Web Speech API 제약)

- **상태:** 해결됨
- **설명:** 모바일 환경(특히 iOS Safari)에서 보스 알리미의 음성 알림(`window.speechSynthesis`)이 제대로 작동하지 않거나, 사용자 상호작용 없이는 재생되지 않는 문제가 발생합니다. 이는 모바일 브라우저의 오디오 자동 재생 정책 및 Web Speech API 지원의 불일치 때문입니다.
- **영향:** 모바일 사용자가 보스 알림을 음성으로 받지 못하여 애플리케이션의 핵심 기능 중 하나를 온전히 활용하기 어렵습니다.
- **해결 방안:**
    - "알림 시작" 버튼 클릭 시 짧은 무음 오디오를 재생하여 오디오 컨텍스트를 활성화하는 방안을 고려합니다.
    - `window.speechSynthesis.getVoices()`를 통해 사용 가능한 음성을 명시적으로 로드하고 설정하는 방안을 검토합니다.
    - 브라우저별 Web Speech API의 동작 특성을 추가로 조사하여 최적의 구현 방법을 찾습니다.

## 4. 해결 과정 및 최종 결과

Web Worker 기술을 도입하여 백그라운드에서의 타이머 신뢰성을 근본적으로 해결하고, 시스템 알림(Notification API)을 통해 음성 알림의 한계를 보완했습니다.

### 주요 조치 사항:
1.  **Web Worker (`timer-worker.js`) 도입:**
    - 메인 스레드와 분리된 별도의 스레드에서 타이머를 실행하여, 모바일 화면이 꺼지거나 브라우저가 백그라운드로 전환되어도 타이머가 멈추지 않고 정확한 시간에 알림 이벤트를 발생시킵니다.
2.  **시스템 알림 (Notification API) 연동:**
    - 브라우저 정책상 백그라운드에서 음성 재생이 제한될 수 있는 상황을 대비하여, OS 레벨의 시스템 알림 배너를 띄우도록 구현했습니다. 이를 통해 사용자는 소리를 못 듣더라도 화면 알림으로 보스 출현을 인지할 수 있습니다.
3.  **음성 재생 안정성 확보:**
    - Web Worker가 정확한 시점에 메인 스레드를 깨워 `speechSynthesis.speak()`를 호출함으로써, 기존 `setInterval` 방식보다 훨씬 안정적으로 음성을 재생할 수 있게 되었습니다.

이로써 모바일 및 PC 백그라운드 환경에서의 알림 누락 문제를 기술적으로 가능한 범위 내에서 최대한 해결했습니다.