# 대규모 기능 개발 및 수정 작업 가이드

## 1. 목적
이 문서는 프로젝트에 중대하고 영향 범위가 넓은 변경(기능 추가, 리팩토링 등)을 가할 때, 일관되고 안정적이며 효율적인 작업 절차를 따르기 위해 작성되었습니다.

## 2. 5대 핵심 원칙
1.  **기획 우선 (Planning-First):** 모든 작업은 전문가의 검토를 거친 상세 기획서로부터 시작합니다.
2.  **체크리스트 기반 구현 (Checklist-Driven):** 기획서를 바탕으로 유닛 단위의 상세한 체크리스트를 작성하여 작업을 체계적으로 관리합니다.
3.  **자율적/점진적 개발 (Autonomous & Incremental):** 체크리스트에 따라 자율적으로 구현하되, 작업은 논리적 단위로 나누어 커밋하여 안정성과 추적성을 확보합니다.
4.  **지속적 품질 관리 (Continuous Quality):** 각 단위 작업이 끝날 때마다 개발자 레벨의 빠른 검증(Smoke Test)과 린트(Lint) 검사를 반드시 수행합니다.
5.  **명확한 보고 (Clear Reporting):** 작업 진행 상황은 체크리스트 업데이트로 명확히 공유하며, 예상치 못한 문제 발생 시 즉시 보고합니다.

## 3. 상세 워크플로우
1.  **1단계: 기획 및 전문가 검토**
    *   `docs/feature-xxx.md` 와 같은 상세 기획서를 작성합니다.
    *   시니어 개발자(또는 의사결정권자)에게 기획서 검토를 요청하여 잠재적 사이드 이펙트나 엣지 케이스를 보완합니다.
    *   피드백을 반영하여 기획서를 최종 확정합니다.

2.  **2단계: 체크리스트 생성**
    *   확정된 기획서를 바탕으로, 구현 및 검증을 위한 상세한 유닛 단위 체크리스트(`docs/checklist-xxx.md`)를 생성합니다.

3.  **3단계: 브랜치 생성**
    *   기능에 대한 설명적인 영문명으로 새 브랜치를 생성합니다. (예: `feature/mobile-navigation`)

4.  **4단계: 구현-검증-커밋 주기 (핵심 루프)**
    *   체크리스트의 논리적 단위를 기준으로 아래 절차를 반복합니다.
        1.  **구현:** 코드 작성
        2.  **자체 검증:** 개발자 레벨의 빠른 시각적/기능적 확인 (Smoke Test)
        3.  **체크리스트 업데이트:** 완료된 항목을 `[x]`로 표시하여 `docs/checklist-xxx.md` 파일 수정
        4.  **린트 실행:** `npm run lint` (또는 대체 명령어)로 코드 품질 자동 검증
        5.  **커밋:** 변경된 파일들을 스테이징하고, 명확한 영문 메시지와 함께 논리적 단위로 커밋

### 4.6 파일 수정 원칙 (Gemini 전용)

안정적이고 정확한 코드 수정을 위해 다음 원칙을 엄격히 준수합니다.

1.  **단일 작업 단위:** 한 번에 하나의 작은 기능 또는 버그 수정에만 집중합니다. 여러 기능을 동시에 구현하거나 광범위한 코드 변경은 지양합니다.
2.  **파일별 순차 처리:** 여러 파일을 수정해야 할 경우, 각 파일을 순차적으로 열고 → 수정하고 → 저장한 뒤 → 다음 파일로 넘어갑니다.
3.  **수정 전 → 읽기 → 후 수정:** `replace` 도구를 사용하기 직전에는 반드시 `read_file`을 사용하여 현재 파일의 정확한 내용을 확인한 후 `old_string`을 구성합니다.
4.  **명확한 `old_string`:** `replace` 도구 사용 시 `old_string`은 변경될 코드 블록을 정확히 식별할 수 있도록 충분한 컨텍스트(최소 3줄 이상의 주변 코드)를 포함하여 구성합니다. 불필요한 공백이나 줄 바꿈 문자에도 유의합니다.
5.  **`write_file` 활용:** 파일의 내용 대부분을 변경하거나 새로운 내용을 완전히 작성할 때는 `read_file`로 원본 내용을 가져와 필요한 모든 변경사항을 반영한 후, 완성된 전체 파일 내용으로 `write_file`을 사용합니다.
6.  **즉각적인 검증:** 모든 파일 수정 후에는 `npm run lint`와 `npm test`를 실행하여 문법적 오류 및 기능적 회귀를 즉시 검증합니다.
7.  **오류 발생 시 보고 및 복구:** 예상치 못한 문제가 발생하면 즉시 작업을 중단하고, `git restore` 또는 `git reset --hard` 명령어를 사용하여 안정적인 상태로 복구한 뒤 사용자에게 보고합니다.

### 4.7 오류 발생 시 Gemini의 행동 지침
1.  **`replace` 실패 시:**
    *   `replace` 도구가 `old_string`을 찾지 못하거나 예상과 다르게 작동하면, 즉시 해당 파일의 **최신 내용을 `read_file`로 다시 읽어 `old_string`이 현재 파일 상태와 정확히 일치하는지 재확인**합니다.
    *   파일 내용을 다시 확인하고 `old_string`을 재구성하기 전에는 어떠한 재시도도 하지 않습니다.
2.  **`lint` 또는 `test` 실패 시:**
    *   명령어 실행 후 출력되는 모든 메시지를 **주의 깊게 분석하여 오류의 정확한 원인을 파악**합니다. 단순한 `Exit Code: 0` 여부만을 확인하지 않고, 경고 및 오류 메시지의 내용을 완벽히 이해하도록 노력합니다.
    *   실패한 경우, **즉시 원인 분석에 착수하며 사용자에게 상황을 명확히 보고**합니다.
3.  **상태 혼란 방지:**
    *   작업 중 파일 상태, `lint` 결과, 또는 커밋 이력 등에 대한 혼란이 발생하면, **즉시 `git status`, `git diff`, `git log` 등의 명령어를 활용하여 현재 저장소의 상태를 정확히 파악**합니다.
    *   필요하다고 판단될 경우, 사용자에게 상황을 보고하고 `git restore` 또는 `git reset --hard`를 제안하여 안정적인 상태로 복구 후 작업을 재개합니다.


5.  **5단계: 완료 보고**
    *   '최종 검증'을 제외한 모든 체크리스트 항목이 완료되면, 구현 완료를 보고합니다.
    *   이후 단계(사용자/QA의 최종 검증)를 위해 대기합니다.

**※ 예외 처리:** 구현 중 해결이 어려운 기술적 문제나 심각한 충돌이 발생하면, 즉시 작업을 중단하고 상황을 보고합니다.
