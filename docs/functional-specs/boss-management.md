# 보스 관리 (Boss Management)

**1. 개요**
'보스 관리' 화면은 사용자가 알림을 받고자 하는 보스 목록을 직접 입력하고 관리하는 핵심 기능입니다. 텍스트 영역에 보스 이름과 출현 시간을 직접 입력하여 사용자 맞춤형 보스 스케줄을 생성하고 저장할 수 있습니다. 입력된 목록은 파싱, 유효성 검사, 정렬 과정을 거쳐 시스템에 반영됩니다.

**2. 기능 접근**
*   사용자는 좌측 사이드바 메뉴 또는 모바일 환경의 '더보기' 메뉴에서 '보스 설정' 메뉴 항목을 클릭하여 '보스 관리' 화면으로 이동합니다.

**3. 보스 목록 입력 및 표시**
*   **입력 방식:**
    *   화면 중앙의 텍스트 영역(`bossListInput`)에 보스 목록을 직접 입력합니다.
    *   각 줄은 `HH:MM 보스이름` 또는 `HH:MM:SS 보스이름` 형식으로 입력해야 합니다.
    *   시간은 `HHMM` (예: `1305`는 13시 05분), `HHMMSS` (예: `130530`은 13시 05분 30초)와 같은 숫자 형식으로도 입력할 수 있습니다.
    *   `MM.DD` 형식의 날짜를 입력하여 날짜 마커를 삽입할 수 있습니다. (예: `01.01`)
*   **초기 로드 시:** 애플리케이션 초기 로딩 시 `BossDataManager`에 저장된 현재 활성화된 보스 목록이 텍스트 영역에 자동으로 채워집니다. 이 때, 시간은 '보스 스케줄러'에서 입력했거나 사용자가 직접 수정한 형식(`HH:MM` 또는 `HH:MM:SS`)을 기억하여 그대로 표시됩니다.
*   **텍스트 영역 업데이트:** "보스 설정 저장" 버튼 클릭 후 성공적으로 저장되면, 시스템에 반영된 보스 목록이 다시 텍스트 영역에 표시됩니다. 이때, 보스는 시간 순으로 정렬되고 필요한 날짜 마커가 자동으로 삽입됩니다.

**4. 보스 설정 저장**
*   **저장 트리거:** 텍스트 영역에 보스 목록을 입력하거나 수정한 후 '보스 설정 저장' 버튼(`sortBossListButton`)을 클릭하면 저장 과정이 시작됩니다.
*   **데이터 처리:**
    1.  텍스트 영역의 내용(`bossListInput.value`)은 `boss-parser.js`의 `parseBossList()` 함수를 통해 파싱됩니다.
    2.  파싱 과정에서 각 보스의 시간 형식, 날짜 형식, 보스 이름 유무 등에 대한 유효성 검사가 수행됩니다.
    3.  현재 `BossDataManager`에 저장된 보스 목록과 비교하여, 기존 보스에 대한 변경은 ID와 알림 상태를 유지하면서 시간만 업데이트됩니다 (Smart Merge). 새로운 보스에는 새로운 고유 ID가 부여됩니다.
    4.  파싱 및 병합된 보스 목록은 시간 순으로 정렬되고, 필요한 날짜 마커가 자동으로 삽입되어 `BossDataManager`에 최종 반영됩니다.
    5.  `BossDataManager`에 데이터가 성공적으로 반영되면, 시스템에 의해 `updateBossListTextarea()`가 호출되어 텍스트 영역의 내용이 정렬되고 포맷팅된 최신 상태로 갱신됩니다.
*   **사용자 피드백:**
    *   **저장 성공:** 성공적으로 저장되면 "보스 목록이 업데이트되었습니다."와 같은 메시지가 로그에 기록됩니다.
    *   **유효성 검사 실패:** 입력 형식에 오류가 있을 경우, 오류가 발생한 줄 번호와 함께 경고 메시지(`alert`)가 표시되고 로그에 기록됩니다. 이 경우 저장 작업은 취소됩니다.

**5. 미저장 변경 사항 감지 및 경고**
*   **변경 감지:** 사용자가 텍스트 영역의 내용을 수정하면, `window.isBossListDirty` 플래그가 `true`로 설정되어 미저장 변경 사항이 있음을 시스템에 알립니다.
*   **경고 메시지:** `window.isBossListDirty`가 `true`인 상태에서 "보스 설정 저장" 버튼을 클릭하지 않고 다른 화면으로 이동하려고 하면, "값이 저장되지 않았습니다. 그래도 화면을 이동하시겠습니까?"라는 확인 메시지(`confirm` 대화상자)가 표시됩니다.
    *   '취소' 선택 시: 화면 전환이 중단됩니다.
    *   '확인' 선택 시: 화면이 전환되며, '보스 관리' 화면의 텍스트 영역 내용은 저장되지 않은 수정 사항이 폐기되고 마지막으로 저장된 상태로 되돌아갑니다.