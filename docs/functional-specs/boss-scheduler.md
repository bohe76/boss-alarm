# 보스 스케줄러 (Boss Scheduler)

**1. 개요**
'보스 스케줄러' 화면은 사용자가 미리 정의된 게임 또는 직접 생성한 커스텀 보스 목록을 선택하고, 각 보스에 대해 "남은 시간"을 입력하여 출현 시간을 계산하며, 이를 전체 보스 목록에 적용하는 기능을 제공합니다. 이 화면을 통해 사용자는 여러 보스의 젠 시간을 효율적으로 관리하고 일괄적으로 업데이트할 수 있습니다.

**2. 기능 접근**
*   사용자는 좌측 사이드바 메뉴 또는 모바일 환경의 '더보기' 메뉴에서 '보스 스케줄러' 메뉴 항목을 클릭하여 '보스 스케줄러' 화면으로 이동합니다.

**3. 보스 목록 선택 및 표시**
*   **게임 선택 드롭다운:** 화면 상단의 드롭다운(`gameSelect`)을 통해 미리 정의된 게임 목록(예: "기본 보스 목록") 또는 사용자가 생성한 커스텀 보스 목록을 선택할 수 있습니다. 커스텀 보스 목록은 이름 앞에 `*` 표시로 구분됩니다.
*   **보스 입력 필드 렌더링:** 드롭다운에서 게임/목록을 선택하면, 해당 목록에 포함된 보스들의 이름과 "남은 시간" 입력 필드, 그리고 "젠 시간" 표시 영역이 동적으로 화면에 생성됩니다.
*   **커스텀 보스 관리 모달 접근:** '커스텀 보스 관리' 버튼을 클릭하여 '개인 보스 목록' 모달을 열 수 있습니다. 이 모달에서 커스텀 보스 목록을 추가, 수정, 삭제하면 '보스 스케줄러' 화면의 게임 선택 드롭다운에 즉시 반영됩니다.

**4. 남은 시간 입력 및 젠 시간 계산**
*   **남은 시간 입력 필드:** 각 보스 옆에 있는 입력 필드(`remaining-time-input`)에 해당 보스까지 남은 시간을 입력합니다.
    *   **입력 형식:** `HH:MM:SS`, `HH:MM`, `HHMM`, `HHMMSS` (표준 시계 시간) 또는 `MM:SS`, `MMSS` (남은 시간) 형식 모두 가능합니다.
*   **젠 시간 자동 계산:** "남은 시간" 필드에 값을 입력하거나 수정하면, 입력된 시간을 기준으로 보스 출현 시간(젠 시간)이 자동으로 계산되어 해당 보스 옆의 "젠 시간" 영역(`calculated-spawn-time`)에 표시됩니다. 이때, **표시 형식은 사용자의 입력 형식을 따릅니다.**
    *   사용자가 초(second)를 포함하지 않은 형식(예: `1230`, `12:30`)으로 입력하면, 젠 시간은 `HH:MM`으로 표시됩니다.
    *   사용자가 초를 포함한 형식(예: `123015`, `12:30:15`)으로 입력하면, 젠 시간은 `HH:MM:SS`으로 표시됩니다.
*   **유효성 검사:** 입력된 "남은 시간"이 유효한 시간 형식이 아닐 경우, "젠 시간" 영역에는 `--:--:--`가 표시됩니다.

**5. 보스 설정 적용**
*   **트리거:** 모든 보스에 대한 "남은 시간" 입력 또는 수정 완료 후 '보스 설정 적용' 버튼(`moveToBossSettingsButton`)을 클릭하면 현재 입력된 스케줄을 시스템에 반영합니다.
*   **데이터 처리:**
    1.  각 보스의 "남은 시간" 입력 필드에 있는 값과 계산된 "젠 시간"을 기반으로 보스 데이터를 구성합니다.
    2.  이때, `data-id` 속성을 통해 기존 보스에 해당하는 ID를 유지하여 `BossDataManager`와의 병합 시 기존 알림 상태가 보존되도록 합니다.
    3.  **특수 보스 처리 (12시간 추가):** `src/screens/boss-scheduler.js` 파일 내 `specialBossNames` 배열에 명시적으로 지정된 보스들(예: **"파르바"**, **"셀로비아"**, **"침공 파르바"** 등 현재 이 목록에 포함된 보스들)에 대해 "남은 시간"이 입력되면, 계산된 젠 시간에 정확히 12시간을 더한 추가적인 젠 시간 항목이 자동으로 생성됩니다. 이로써 이들 보스는 하루에 두 번 출현할 수 있는 스케줄을 가집니다.
    4.  **"침공" 보스 당일 필터링:** 이름에 **"침공"**이라는 단어가 포함된 *모든* 보스(예: **"침공 파르바"**, **"침공 셀로비아"**, 또는 `specialBossNames`에 포함되지 않더라도 이름에 "침공"이 들어간 보스)의 경우, 계산된 젠 시간(12시간 추가된 시간 포함)이 *현재 날짜*에 속하지 않으면 해당 보스 항목은 목록에서 자동으로 제외됩니다. 이는 "침공" 보스가 당일에만 유효함을 반영합니다.
    5.  구성된 보스 데이터는 `BossDataManager`의 `setBossSchedule()` 함수를 통해 시스템에 반영됩니다. 이 과정에서 전체 보스 목록은 `BossDataManager` 내부에서 재구성(Reconstruction)되어 시간 순으로 정렬되고 날짜 마커가 자동으로 삽입됩니다.
*   **화면 전환:** 보스 설정 적용이 완료되면, 자동으로 '보스 관리' 화면으로 이동하여 사용자가 변경된 보스 목록을 확인할 수 있도록 합니다.

**6. "남은 시간 초기화" 기능**
*   **제어:** '남은 시간 초기화' 버튼(`clearAllRemainingTimesButton`)을 클릭하면 현재 화면에 표시된 모든 "남은 시간" 입력 필드의 내용을 지우고 "젠 시간" 표시를 초기화합니다.

---

## 4.6. 커스텀 보스 목록 관리 (Custom Boss List Management)

**1. 개요**
'개인 보스 목록'은 사용자가 자신만의 보스 목록을 생성, 관리하고 이를 '보스 스케줄러' 화면에서 선택하여 사용할 수 있도록 하는 기능입니다. 이 기능은 모달 형태로 제공되며, 로컬 스토리지에 데이터를 영구적으로 저장합니다.

**2. 기능 접근**
*   **모달 열기:** '보스 스케줄러' 화면에서 '커스텀 보스 관리' 버튼(`manageCustomListsButton`)을 클릭하여 '개인 보스 목록' 모달을 엽니다.
*   **모달 닫기:** 모달 상단의 닫기 버튼(`closeCustomListModal`) 또는 모달 외부 영역 클릭 시 모달이 닫힙니다.

**3. 탭 전환 기능**
*   **탭 구성:** 모달 내부에 '목록 추가' 탭과 '목록 관리' 탭으로 구성됩니다.
*   **전환 방식:** 각 탭 버튼 클릭 시 해당 탭의 콘텐츠가 표시되고, 다른 탭의 콘텐츠는 숨겨집니다.
*   **초기 상태:** 모달이 열리면 기본적으로 '목록 추가' 탭이 활성화되어 표시됩니다.

**4. '목록 추가' 탭 기능**
*   **목록 이름 입력:** 새로운 커스텀 목록의 이름을 텍스트 입력 필드(`customListNameInput`)에 입력합니다.
*   **보스 목록 내용 입력:** 추가할 보스들의 이름을 한 줄에 하나씩 텍스트 영역(`customListContentTextarea`)에 입력합니다.
*   **저장:** '저장' 버튼(`saveCustomListButton`) 클릭 시 새로운 커스텀 목록이 로컬 스토리지에 저장됩니다.
*   **유효성 검사:**
    *   **목록 이름:** 비어 있거나, 50자를 초과하거나, 허용되지 않는 특수 문자(영문, 한글, 숫자, 공백, 하이픈, 밑줄, 괄호 외)를 포함할 수 없습니다.
    *   **이름 중복:** 기존 커스텀 목록 이름 또는 미리 정의된 게임 목록(`boss_lists.json`에 있는 게임 이름)과 중복될 수 없습니다.
    *   **보스 내용:** 비어 있거나, 유효한 보스 이름이 없거나, 보스 이름이 50자를 초과하거나, 제어 문자를 포함할 수 없습니다.
*   **피드백:** 유효성 검사 실패 시 경고 메시지(`alert`)가 표시되고, 성공 시 "목록이 추가되었습니다." 메시지가 로그에 기록됩니다.
*   **보스 스케줄러 갱신:** 목록 추가 성공 시 '보스 스케줄러' 화면의 게임 선택 드롭다운이 자동으로 갱신됩니다.

**5. '목록 관리' 탭 기능**
*   **커스텀 목록 표시:** 현재 저장된 모든 커스텀 보스 목록의 이름(`customListManagementContainer` 내)이 표시됩니다.
*   **목록별 작업:** 각 목록 옆에는 '수정' 버튼과 '삭제' 버튼이 제공됩니다.
        *   **수정:** '수정' 버튼 클릭 시 해당 목록의 이름과 내용을 '목록 추가' 탭의 입력 필드에 자동으로 채워주고, '저장' 버튼을 '수정' 모드로 변경하여 내용을 업데이트할 수 있도록 합니다. 수정 시 목록 이름 변경도 가능하며, 이 경우 이름 중복 검사가 다시 수행됩니다.
        *   **삭제:** '삭제' 버튼 클릭 시 해당 커스텀 목록을 로컬 스토리지에서 제거합니다. 삭제 전 사용자에게 확인(`confirm`) 메시지를 표시합니다.
*   **피드백:** 목록 수정/삭제 성공 시 관련 메시지가 로그에 기록되며, '보스 스케줄러' 화면의 게임 선택 드롭다운이 자동으로 갱신됩니다.